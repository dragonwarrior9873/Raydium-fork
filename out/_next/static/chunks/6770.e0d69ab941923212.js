(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6770],{66770:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(26729),i=r.n(n),o=r(73944),s=r(59054),a=r.n(s),d=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class h extends i(){constructor(e,t){if(super(),this._network=t,this._publicKey=null,this._popup=null,this._handlerAdded=!1,this._nextRequestId=1,this._autoApprove=!1,this._responsePromises=new Map,this.handleMessage=e=>{var t;if(this._injectedProvider&&e.source===window||e.origin===(null===(t=this._providerUrl)||void 0===t?void 0:t.origin)&&e.source===this._popup){if("connected"===e.data.method){let t=new o.nh(e.data.params.publicKey);this._publicKey&&this._publicKey.equals(t)||(this._publicKey&&!this._publicKey.equals(t)&&this.handleDisconnect(),this._publicKey=t,this._autoApprove=!!e.data.params.autoApprove,this.emit("connect",this._publicKey))}else if("disconnected"===e.data.method)this.handleDisconnect();else if(e.data.result||e.data.error){let t=this._responsePromises.get(e.data.id);if(t){let[r,n]=t;e.data.result?r(e.data.result):n(Error(e.data.error))}}}},this._beforeUnload=()=>{this.disconnect()},"object"==typeof e&&null!==e&&"postMessage"in e&&"function"==typeof e.postMessage)this._injectedProvider=e;else if("string"==typeof e)this._providerUrl=new URL(e),this._providerUrl.hash=new URLSearchParams({origin:window.location.origin,network:this._network}).toString();else throw Error("provider parameter must be an injected provider or a URL string.")}handleConnect(){var e;return(this._handlerAdded||(this._handlerAdded=!0,window.addEventListener("message",this.handleMessage),window.addEventListener("beforeunload",this._beforeUnload)),this._injectedProvider)?new Promise(e=>{this.sendRequest("connect",{}),e()}):(window.name="parent",this._popup=window.open(null===(e=this._providerUrl)||void 0===e?void 0:e.toString(),"_blank","location,resizable,width=460,height=675"),new Promise(e=>{this.once("connect",e)}))}handleDisconnect(){this._handlerAdded&&(this._handlerAdded=!1,window.removeEventListener("message",this.handleMessage),window.removeEventListener("beforeunload",this._beforeUnload)),this._publicKey&&(this._publicKey=null,this.emit("disconnect")),this._responsePromises.forEach(([,e],t)=>{this._responsePromises.delete(t),e(Error("Wallet disconnected"))})}sendRequest(e,t){return d(this,void 0,void 0,function*(){if("connect"!==e&&!this.connected)throw Error("Wallet not connected");let r=this._nextRequestId;return++this._nextRequestId,new Promise((n,i)=>{var o,s,a,d;this._responsePromises.set(r,[n,i]),this._injectedProvider?this._injectedProvider.postMessage({jsonrpc:"2.0",id:r,method:e,params:Object.assign({network:this._network},t)}):(null===(o=this._popup)||void 0===o||o.postMessage({jsonrpc:"2.0",id:r,method:e,params:t},null!==(a=null===(s=this._providerUrl)||void 0===s?void 0:s.origin)&&void 0!==a?a:""),this.autoApprove||null===(d=this._popup)||void 0===d||d.focus())})})}get publicKey(){return this._publicKey}get connected(){return null!==this._publicKey}get autoApprove(){return this._autoApprove}connect(){return d(this,void 0,void 0,function*(){this._popup&&this._popup.close(),yield this.handleConnect()})}disconnect(){return d(this,void 0,void 0,function*(){this._injectedProvider&&(yield this.sendRequest("disconnect",{})),this._popup&&this._popup.close(),this.handleDisconnect()})}sign(e,t){return d(this,void 0,void 0,function*(){if(!(e instanceof Uint8Array))throw Error("Data must be an instance of Uint8Array");let r=yield this.sendRequest("sign",{data:e,display:t}),n=a().decode(r.signature),i=new o.nh(r.publicKey);return{signature:n,publicKey:i}})}signTransaction(e){return d(this,void 0,void 0,function*(){let t=yield this.sendRequest("signTransaction",{message:a().encode(e.serializeMessage())}),r=a().decode(t.signature),n=new o.nh(t.publicKey);return e.addSignature(n,r),e})}signAllTransactions(e){return d(this,void 0,void 0,function*(){let t=yield this.sendRequest("signAllTransactions",{messages:e.map(e=>a().encode(e.serializeMessage()))}),r=t.signatures.map(e=>a().decode(e)),n=new o.nh(t.publicKey);return e=e.map((e,t)=>(e.addSignature(n,r[t]),e))})}diffieHellman(e){return d(this,void 0,void 0,function*(){if(!(e instanceof Uint8Array))throw Error("Data must be an instance of Uint8Array");let t=yield this.sendRequest("diffieHellman",{publicKey:e});return t})}}},74738:function(e,t,r){"use strict";var n=r(89509).Buffer;e.exports=function(e){if(e.length>=255)throw TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==t[s])throw TypeError(o+" is ambiguous");t[s]=i}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return n.alloc(0);for(var r=0,i=0,o=0;e[r]===d;)i++,r++;for(var s=(e.length-r)*h+1>>>0,c=new Uint8Array(s);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var u=0,p=s-1;(0!==l||u<o)&&-1!==p;p--,u++)l+=a*c[p]>>>0,c[p]=l%256>>>0,l=l/256>>>0;if(0!==l)throw Error("Non-zero carry");o=u,r++}for(var f=s-o;f!==s&&0===c[f];)f++;var v=n.allocUnsafe(i+(s-f));v.fill(0,0,i);for(var _=i;f!==s;)v[_++]=c[f++];return v}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=n.from(t)),!n.isBuffer(t))throw TypeError("Expected Buffer");if(0===t.length)return"";for(var r=0,i=0,o=0,s=t.length;o!==s&&0===t[o];)o++,r++;for(var h=(s-o)*c+1>>>0,l=new Uint8Array(h);o!==s;){for(var u=t[o],p=0,f=h-1;(0!==u||p<i)&&-1!==f;f--,p++)u+=256*l[f]>>>0,l[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw Error("Non-zero carry");i=p,o++}for(var v=h-i;v!==h&&0===l[v];)v++;for(var _=d.repeat(r);v<h;++v)_+=e.charAt(l[v]);return _},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw Error("Non-base"+a+" character")}}}},59054:function(e,t,r){var n=r(74738);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")}}]);